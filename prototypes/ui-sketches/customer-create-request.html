<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>予約リクエスト作成 - サロン予約システム</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div class="max-w-md mx-auto bg-white min-h-screen">
        <!-- ヘッダー -->
        <header class="bg-blue-600 text-white p-4 flex items-center">
            <a href="customer-home.html" class="mr-3">←</a>
            <h1 class="text-xl font-bold">予約リクエスト作成</h1>
        </header>

        <!-- メインコンテンツ -->
        <main class="p-4">
            <form class="space-y-6">
                <!-- 日時選択 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        希望日時 <span class="text-red-500">*</span>
                    </label>
                    <div class="space-y-2">
                        <input type="date" id="date-input" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        <select id="time-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                            <option value="">時間を選択</option>
                            <option value="09:00">09:00</option>
                            <option value="10:00">10:00</option>
                            <option value="11:00">11:00</option>
                            <option value="12:00">12:00</option>
                            <option value="13:00">13:00</option>
                            <option value="14:00">14:00</option>
                            <option value="15:00">15:00</option>
                            <option value="16:00">16:00</option>
                            <option value="17:00">17:00</option>
                            <option value="18:00">18:00</option>
                        </select>
                    </div>
                    <div id="duration-display" class="mt-2 p-2 bg-blue-50 border border-blue-200 rounded-lg hidden">
                        <p class="text-sm text-blue-800">
                            <span id="duration-text"></span>
                        </p>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">※ カレンダーUIは実装時に改善</p>
                </div>

                <!-- メニュー選択 -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        メニュー <span class="text-red-500">*</span>
                    </label>
                    <select id="menu-select" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" required>
                        <option value="">メニューを選択</option>
                        <option value="cut">カット</option>
                        <option value="cut-color">カット + カラー</option>
                        <option value="cut-perm">カット + パーマ</option>
                        <option value="cut-color-perm">カット + カラー + パーマ</option>
                    </select>
                </div>

                <!-- 顧客名（自動入力） -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        お名前
                    </label>
                    <input type="text" value="山田太郎" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" readonly>
                    <p class="text-xs text-gray-500 mt-1">※ LINEの表示名から自動入力</p>
                </div>

                <!-- 連絡手段（任意） -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        連絡手段（任意）
                    </label>
                    <input type="text" placeholder="LINE、電話番号など" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                </div>

                <!-- 送信ボタン -->
                <div class="pt-4">
                    <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700">
                        予約リクエストを送信
                    </button>
                </div>
            </form>
        </main>
    </div>

    <script>
        // メニューの所要時間（分）
        const menuDurations = {
            'cut': 60,              // カット: 1時間
            'cut-color': 180,       // カット + カラー: 3時間
            'cut-perm': 120,        // カット + パーマ: 2時間
            'cut-color-perm': 240   // カット + カラー + パーマ: 4時間
        };

        const dateInput = document.getElementById('date-input');
        const timeSelect = document.getElementById('time-select');
        const menuSelect = document.getElementById('menu-select');
        const durationDisplay = document.getElementById('duration-display');
        const durationText = document.getElementById('duration-text');

        function calculateEndTime() {
            const selectedDate = dateInput.value;
            const selectedTime = timeSelect.value;
            const selectedMenu = menuSelect.value;

            if (!selectedDate || !selectedTime || !selectedMenu) {
                durationDisplay.classList.add('hidden');
                return;
            }

            const duration = menuDurations[selectedMenu];
            if (!duration) {
                durationDisplay.classList.add('hidden');
                return;
            }

            // 開始時刻をDateオブジェクトに変換
            const startDateTime = new Date(`${selectedDate}T${selectedTime}:00`);
            const endDateTime = new Date(startDateTime.getTime() + duration * 60 * 1000);

            // 終了時刻をフォーマット
            const endTime = endDateTime.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit', hour12: false });

            // 表示
            const hours = Math.floor(duration / 60);
            const minutes = duration % 60;
            let durationStr = '';
            if (hours > 0 && minutes > 0) {
                durationStr = `${hours}時間${minutes}分`;
            } else if (hours > 0) {
                durationStr = `${hours}時間`;
            } else {
                durationStr = `${minutes}分`;
            }

            durationText.textContent = `所要時間: ${durationStr} | 終了予定時刻: ${endTime}`;
            durationDisplay.classList.remove('hidden');
        }

        dateInput.addEventListener('change', calculateEndTime);
        timeSelect.addEventListener('change', calculateEndTime);
        menuSelect.addEventListener('change', calculateEndTime);
    </script>
</body>
</html>
